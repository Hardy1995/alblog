<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    全局
    <small>注册与访问</small>
  </h1>
  <ol class="breadcrumb">
    <li><a href="#"><i class="fa fa-dashboard"></i> 全局</a></li>
    <li class="active">注册与访问</li>
  </ol>
</section>
<!-- Main content -->
<section class="content">
  <!-- Small boxes (Stat box) -->
  <div class="row">
    <div class="col-xs-12" >
      <form action="/{{adminpath}}?action=settingnew" onsubmit="return submitNew(event);"
            class="form-horizontal"
            method="post" id="setting" enctype="multipart/form-data">
        {{#each setting}}
        <div class="panel panel-default">
          <div class="panel-heading" >注册与访问控制</div>
          <div class="panel-body">
            <input type="hidden" name="settingnew[access]" VALUE="1"/>
            <div class="row">
              <div class="col-xs-12 col-md-4">
                <div class="title-header">
                  <h4>允许注册新会员</h4>
                </div>
                <div class="panel-body regstatus">
                  <div class="checkbox">
                    <label>
                      <input type="checkbox" name="settingnew[regstatus][0]" value="open"> 开放普通注册
                    </label>
                  </div>
                  <div class="checkbox">
                    <label>
                      <input type="checkbox" name="settingnew[regstatus][1]" value="invite"> 开放邀请注册
                    </label>
                  </div>
                </div>
              </div>
              <div class="hidden-xs col-md-8">
                <div class="right-tips-text">
                  设置是否允许游客注册成为站点会员，您可以根据站点需求选择注册方式
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12 col-md-4">
                <div class="title-header">
                  <h4>关闭注册提示信息:</h4>
                </div>
                <div class="panel-body">
                  <textarea name="settingnew[regclosemessage]" id="" class=".form-control" rows="5">{{regclosemessage}}</textarea>
                </div>
              </div>
              <div class="hidden-xs col-md-8">
                <div class="right-tips-text">
                  当站点关闭注册时的提示信息
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12 col-md-4">
                <div class="title-header">
                  <h4>注册地址:</h4>
                </div>
                <div class="panel-body">
                  <input type="text"class="form-control" name="settingnew[regname]" value="{{regname}}"/>
                </div>
              </div>
              <div class="hidden-xs col-md-8">
                <div class="right-tips-text">
                  设置站点注册地址 mod 值，默认为“reg”，修改名称有利于防止灌水软件，不需要修改任何文件名称，只在此修改即可
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12 col-md-4">
                <div class="title-header">
                  <h4>通过邮件发送注册链接:</h4>
                </div>
                <div class="panel-body sendregisterurl">
                 <div class="radio">
                   <label>
                     <input type="radio" name="settingnew[sendregisterurl]" value="1"/> 是
                   </label>
                   <label>
                     <input type="radio" name="settingnew[sendregisterurl]" value="0"/> 否
                   </label>
                 </div>
                </div>
              </div>
              <div class="hidden-xs col-md-8">
                <div class="right-tips-text">
                  开启后系统会发一条注册的地址到用户的邮箱，从该地址链接过来的允许注册，同时建议UCenter中开启一个邮箱只允许注册一个帐户
                  注意：只有在站长 - 邮件设置中完成邮件设置，确保邮件能发送成功下可以开启该功能
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12 col-md-4">
                <div class="title-header">
                  <h4>新注册用户是否验证邮箱:</h4>
                </div>
                <div class="panel-body regverify">
                 <div class="radio iradio_minimal-blue">
                   <label>
                     <input type="radio" name="settingnew[regverify]" value="0"/> 无
                   </label>
                 </div>
                  <div class="radio">
                   <label>
                     <input type="radio" name="settingnew[regverify]" value="1"/> 邮箱验证
                   </label>
                 </div>
                </div>
              </div>
              <div class="hidden-xs col-md-8">
                <div class="right-tips-text">
                  选择“无”用户可直接注册成功；
                  选择“Email 验证”将向用户注册 Email 发送一封验证邮件以确认邮箱的有效性（开启“通过邮件发送注册链接”该设置自动通过验证）；
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12 col-md-4">
                <div class="title-header">
                  <h4>密码最小长度:</h4>
                </div>
                <div class="panel-body">
                  <input type="text" class="form-control" name="settingnew[pwlength]" value="{{pwlength}}"/>
                </div>
              </div>
              <div class="hidden-xs col-md-8">
                <div class="right-tips-text">
                  新用户注册时密码最小长度，0或不填为不限制
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12 col-md-4">
                <div class="title-header">
                  <h4>强制密码复杂度:</h4>
                </div>
                <div class="panel-body strongpw">
                  <div class="checkbox">
                    <label>
                      <input type="checkbox" name="settingnew[strongpw][0]" value="1"/> 数字
                    </label>
                  </div>
                  <div class="checkbox">
                    <label>
                      <input type="checkbox" name="settingnew[strongpw][1]" value="2"/> 小写字母
                    </label>
                  </div>
                  <div class="checkbox">
                    <label>
                      <input type="checkbox" name="settingnew[strongpw][2]" value="3"/> 大写字母
                    </label>
                  </div>
                  <div class="checkbox">
                    <label>
                      <input type="checkbox" name="settingnew[strongpw][3]" value="4"/> 符号
                    </label>
                  </div>
                </div>
              </div>
              <div class="hidden-xs col-md-8">
                <div class="right-tips-text">
                  新用户注册时密码中必须存在所选字符类型，不选则为无限制
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12 col-md-4">
                <div class="title-header">
                  <h4>注册邮箱域名限制:</h4>
                </div>
                <div class="panel-body toggle">
                  <div class="radio">
                    <label>
                      <input type="radio" name="settingnew[regmaildomain]" value="0"/> 无
                    </label>
                  </div>
                  <div class="radio">
                    <label>
                      <input type="radio" name="settingnew[regmaildomain]" value="1"/> 白名单
                    </label>
                  </div>
                  <div class="radio">
                    <label>
                      <input type="radio" name="settingnew[regmaildomain]" value="2"/> 黑名单
                    </label>
                  </div>
                  <div class="panel-body maildomainlist">
                    <div class="title-header">
                      <h4>限制名单:</h4>
                    </div>
                    <div class="panel-body">
                      <textarea name="settingnew[maildomainlist]" rows="5">{{maildomainlist}}</textarea>
                    </div>
                  </div>
                </div>
              </div>
              <div class="hidden-xs col-md-8">
                <div class="right-tips-text">
                  选择“无”直接关闭本功能；选择“白名单模式”，只有限制名单中的邮箱域名可以注册；选择“黑名单模式”，限制名单中的邮箱域名不能注册。
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12 col-md-4">
                <div class="title-header">
                  <h4>显示网站服务条款:</h4>
                </div>
                <div class="panel-body toggle">
                  <div class="radio">
                    <label>
                      <input type="radio" name="settingnew[bbrules]" value="1"/> 是
                    </label>
                    <label>
                      <input type="radio" name="settingnew[bbrules]" value="0"/> 否
                    </label>
                  </div>
                  <div class="panel-body maildomainlist">
                    <div class="title-header">
                      <h4>服务条款内容:</h4>
                    </div>
                    <div class="panel-body">
                      <textarea name="settingnew[bbrulestxt]" rows="5">{{bbrulestxt}}</textarea>
                    </div>
                  </div>
                </div>
              </div>
              <div class="hidden-xs col-md-8">
                <div class="right-tips-text">
                  新用户注册时显示网站服务条款
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="row">
              <div class="col-xs-12 col-md-6">
                <button type="submit" name="Submit" class="btn btn-success">保存</button>
              </div>
            </div>
          </div>
        </div>
        <script type="text/javascript">

          var regstatus = '{{regstatus}}',
              sendregisterurl ='{{sendregisterurl}}',
              bbrules = '{{bbrules}}',
              regmaildomain = '{{regmaildomain}}',
              strongpw = ('{{strongpw}}').split(","),
              regverify = '{{regverify}}'
          //console.log(sendregisterurl)
          switch (regstatus){
            case '0':
              $(".regstatus input").removeAttr('checked')
              break;
            case '1':
              $(".regstatus input[name='settingnew[regstatus][0]']").attr('checked',true)
              break;
            case '2':
              $(".regstatus input[name='settingnew[regstatus][1]']").attr('checked',true)
              break;
            case '3':
              $(".regstatus input").attr('checked',true)
              break;
            default :
              break;
          }
          $(".sendregisterurl input[name='settingnew[sendregisterurl]'][value='"+sendregisterurl+"']").attr('checked',true)
          $(".toggle input[name='settingnew[bbrules]'][value='"+bbrules+"']").attr('checked',true)
          $(".toggle input[name='settingnew[regmaildomain]'][value='"+regmaildomain+"']").attr('checked',true)
          $(".regverify input[name='settingnew[regverify]'][value='"+regverify+"']").attr('checked',true)
          if(regmaildomain > 0){
            $(".toggle input[name='settingnew[regmaildomain]']").parents('.toggle').find('.maildomainlist').show()
          }
          if(bbrules > 0){
            $(".toggle input[name='settingnew[bbrules]']").parents('.toggle').find('.maildomainlist').show()
          }
          $.each(strongpw,function(i){

            $(".strongpw input[value='"+strongpw[i]+"']").attr('checked',true)
          })
        </script>
        {{/each}}
      </form>
    </div>
  </div>
</section><!-- /.content -->
